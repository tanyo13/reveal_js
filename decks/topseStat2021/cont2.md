
# 確率分布

---

## 標本抽出

* 母集団 (population)
  * 調べたいデータセットの全体．理論的・仮想的であることもある．
* 標本 (sample)
  * 母集団から取り出したデータセット
* 無作為抽出 (random sampling)
  * 要素をランダムに取り出すこと
* 抽出方法
  * 復元抽出 (sampling with replacement) : 抽出した要素を測定した後，要素を母集団に戻す方法
  * 非復元抽出 (sampling without replacement) : 戻さない方法
* バイアス (bias) : 標本が母集団とは異なる傾向を示すこと
* バイアスのないデータを取ることは，データの量より重要

---

## 標本調査

* なぜ標本抽出を行う?
  * 母集団についての性質を知りたい
    * 例: 日本人の体重の平均はどれだけか?
    * 例: ウェブページを改善したら，クリック率は上がるか?
  * 全数調査は現実的にはできない．
* 標本調査は (どのくらい) 信用できるのか?
  * 標本の平均は，母集団の平均と同じか?
    * 違うに決まっているが，標本サイズを大きくすれば，
	  母集団の平均に近づくのか?
      $\to$ Yes. ただし，重要な仮定あり．
  * 現在得られた標本の平均は，母集団の平均にどれくらい近いか?
  * 変数 X の平均と変数 Y の平均では，どちらが大きいのか?
* これらの質問に答えるために，確率分布について知る必要がある．

---

## バイアス

* 標本が，母集団からバイアス無く抽出されていることが重要
* 1936年米国大統領選挙予想
  * Literary Digest 誌
    * 一千万人を対象に調査．
	* 調査対象は，電話や自動車を持つ人
	* 予想: ルーズベルト43% ランドン57%
  * Gallup 社
    * 三千人を対象
	* 居住地域，性別，年齢，人種の構成比を観察して3,000を割り振る
	* 予想: ルーズベルト54% ランドン46%
  * 結果: ルーズベルト60% ランドン40%
* Gallup 社も1948年には失敗 → 無作為抽出へ

---

ここは飛ばしているけれど，
バイアスのあるデータを生成する例を書いても良いかもしれない．
<!-- .element: class="fixme" -->


---

## 確率分布

* 確率分布 (probability distribution)
* データの取り得る値が有限である場合
  * 各データ値に，確率が付与される．表で示すことができる．
  * 和は1
* 例: 歪みの無いサイコロを2個投げた場合の確率分布
<img src="figs/dicetwo.jpg" width="80%">

---

## 確率分布 (つづき)

* データの取り得る値が無限の場合 
  * 例: 0以上10以下の実数 / 0以上の実数 / 実数であれば何でも
* もはや，表を書くことは不可能．
* そもそも，「値が 4.725 になる確率」って何?
  * 0に決まっているので，考えても仕方が無い．
* 値が「ある範囲内に入る確率」なら，意味がある．
  * 「値が 2 以上 3 以下になる確率は 0.35 である」

---

## 確率密度関数
    
* 確率密度関数 (probability density function = PDF)
* 確率を関数 $f$ で表現する．
  * 値が常に0以上になるような関数だけを考える．
  * 値が $a$ 以上 $b$ 以下になる確率
    $= \displaystyle{\int_a^b f(x)dx} = $
    下図の面積
* したがって，$\displaystyle{\int_{-\infty}^{\infty} f(x)dx = 1}$
  となる必要がある．

<img src="figs/densityFunc.jpg" width="40%">


---

* 平均 (期待値) $\mu$

$$ \mu = \int_{-\infty}^{\infty} x f(x) dx $$

* 分散 $\sigma^2$, 標準偏差 $\sigma$

$$ \sigma^2 = \int_{-\infty}^{\infty} (x - \mu)^2 f(x) dx $$

---

# 確率分布各論

---

## 一様分布 (離散)

* 一様分布 (uniform distribution)
* 整数 $a$, $b$ (ただし$a < b$) について，
  $a$ 以上 $b$ 以下の整数をどれも同じ確率で取り，
  それ以外の値はとらないような分布
  * $N := b - a + 1$
* 確率分布 $P(X=x) = 1/N $
* 期待値 $E(X) = (a + b) / 2$, 
  分散 $V(X) = (n^2 - 1) / 12$

---

## 超幾何分布

* 超幾何分布 (hypergeometric distribution)
* 母集団: 全部で $N$個．成功状態にあるものが $K$ 個．
  ここから $n$ 個取り出したときに，成功状態が $x$ 個である確率を与える分布．
  * $p := K / N$
  * 非復元抽出に相当
* 確率分布 $P(X=x) = \displaystyle{\frac{\binom{K}{x}\binom{N-K}{n-x}}{\binom{N}{n}}} $
* 期待値 $E(X) = np$, 
  分散 $\displaystyle{V(X) = np(1-p)\frac{N-n}{N-1}}$
* $N$ が大きいときは，二項分布に近い．
* $p$ が小さく $n$ が大きいときには，ポアソン分布に近い．

---

## 二項分布

* $\textit{Bi}(n, p)$ : 二項分布 (binomial distribution)
* 成功する確率が $p$ である試行を，独立に $n$ 回繰り返す．
  * ベルヌーイ試行 (Bernoulli trial) と呼ぶ
* $x$ 回成功する確率を与える分布
* 確率分布 $\displaystyle{P(X=x) = \binom{n}{x}p^x(1-p)^{n-x}}$
* 期待値 $E(X) = np$, 
  分散 $V(X) = np(1-p)$

---

## ポアソン分布

* $\textit{Po}(\lambda)$ : ポアソン分布 (Poisson distribution)
* 二項分布で，$n$ が大きく，$p$ が小さい場合を近似する分布
  * $\lambda := np$ は一定とする．
* 確率分布 
  $\displaystyle{P(X = x) = 
   \frac{e^{-\lambda}\lambda^x}{x!}}$
* 期待値 $E(X) = \lambda$, 
  分散 $V(X) = \lambda$

---

## 幾何分布

* 確率 $p$ のベルヌーイ試行で，はじめて成功するまでの回数が $x$ で
  ある確率を与える分布
  * $q := 1 - p$ : 失敗する確率
* 確率分布 $P(X = x) = pq^{x - 1}$
* 期待値 $E(X) = 1/p\quad$ 分散 $V(X) = q/p^2$
* 待ち時間分布 (waiting time distribution) と呼ばれる


---

## 一様分布 (連続)

* 一様分布 (uniform distribution)
* 実数 $a$, $b$ (ただし$a < b$) について，
  $a$ 以上 $b$ 以下の値をどれも同じ確率で取り，
  それ以外の値はとらないような分布
* 確率分布:
<img src="figs/uniformDist.jpg" width="40%">
* 平均 $E(X) = (a + b) / 2\quad$  分散 $V(X) = ((b - a)^2 - 1) / 12$

---

## 正規分布

* $N(0, 1)$ : 標準正規分布 (standard normal distribution)  
  * 期待値0, 分散1

$$
f(x) = \frac{1}{\sqrt{2\pi}}
       \exp\left(-\frac{1}{2}x^2\right)
$$

* $N(\mu, \sigma^2)$ : 正規分布 (normal distribution)      
  * 期待値$\mu$, 分散$\sigma^2$
  * 標準正規分布を$x$軸方向に$\sigma$倍拡大，$y$軸方向に$1/\sigma$倍拡大，
    $x$軸方向に$\mu$平行移動したもの

$$
f(x) = \frac{1}{\sqrt{2\pi}\sigma}
       \exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)
$$

---

<p><img src="figs/normDist1.jpg" width="40%"></p>

<p><img src="figs/normDist2.jpg" width="40%"></p>


---

## 指数分布

* 幾何分布の連続版．事象が生起するまでの時間が$x$である確率を表す分布
* 確率分布 $f(x) = \lambda e^{-\lambda x}$
* 期待値 $E(X) = 1/\lambda \quad$ 分散 $V(X) = 1/\lambda^2$
* 故障率が一定のシステムの故障までの時間，次の災害までの時間，....
  * 平均と標準偏差が一致
    * いつ起こっても不思議はない....(?)



---


## 大数の法則

* 概略: 標本サイズを大きくすれば，標本データの平均は母集団の平均に近づく．
* 数学的定式化 (「強法則」バージョン)
  * 確率変数 $X_1, X_2, \ldots$
    * 互いに独立
	* 同一の分布に従う
	* その分布は，平均 $\mu$ も分散 $\sigma^2$ も有限の値を取る
  * 確率変数 $\overline{X_n} := (X_1 + \cdots + X_n) / n$ 
  * このとき，$ \displaystyle{ \lim_{n\to\infty}\overline{X_n} = \mu } $
    が，確率1で成立する．
* 例: 硬貨を投げ続ける．$n$回までの表の回数を $h(n)$ とするとき，
  $ \displaystyle{ \lim_{n\to\infty}\frac{h(n)}{n} = \frac{1}{2} } $
  となる確率は 1 である．
* 「あたりまえ」と思うかもしれないが...

---

## 標本平均の分布

* 標本平均の分布を知りたい ← なぜ?
* 1,000人を無作為抽出して聞いてみた．
  X を好む人は 562 人いた．Y を好む人は 538 人いた．
  * 母集団で，Xを好む人は 50% 以上いる，と言ってしまうと，
    どれくらい危険だろうか? ...(*)
  * 母集団で，Yを好む人より X を好む人が多い，と言ってしまうと，
    どれくらい危険だろうか?

---

## 標本平均の分布 (つづき)

* Zが成り立つ確率が50%である母集団があったとして，ここから
  「サイズ1,000の標本をとって，Zが成り立っている要素を数える」
  ことを多数回繰り返したとする．
  * 左図になるのだったら ... (*) は，まあ安全
  * 右図になるのだったら ... (*) は，かなり危険

<img src="figs/virtSamplDist1.jpg">

---

## 標本平均の分布 (つづき)

* 「サイズ1,000の標本の平均値」がどう振る舞うのかが知りたい．
  * 母集団の分布に依存しそう → Yes.
  * しかし，サイズが大きいときには近似ができる

---

## 中心極限定理

* 中心極限定理 (central limit theorem = CLT)
* 概略: 母集団が何であっても，標本サイズが大きければ，
  標本平均の分布はおおむね正規分布になる．
* 数学的定式化: 
  * 大数の法則に掲げたのと同じ仮定
    * $\mu$: 母集団の平均，$\sigma^2$: 母集団の分散
  * $F$ : $N(0, (\sigma/\sqrt{n})^2)$ の累積確率密度関数
    * すなわち，
      $\displaystyle{F(x) = \frac{1}{\sqrt{2\pi}(\sigma/\sqrt{n})}
      \int_{-\infty}^{x}\exp\left(-\frac{x^2}{2(\sigma/\sqrt{n})^2}\right)dx}$
  * $P(\phi)$ : $\phi$ の起こる確率，とするとき
$$ \lim_{n\to\infty} P(\overline{X_n} - \mu < \alpha) = F(\alpha) $$


  
  


